{"version":3,"file":"fetch-inject.min.js","sources":["../src/injectors.js","../src/fetch-inject.js"],"sourcesContent":["export const script = (function(i,s,o,g,r,a,m){a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.appendChild(s.createTextNode(g));a.onload=r;m?m.parentNode.insertBefore(a,m):s.head.appendChild(a)}) // eslint-disable-line\nexport const style = (function(i,s,o,g,r,a,m){a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.type='text/css';a.appendChild(s.createTextNode(g));m?m.parentNode.insertBefore(a,m):s.head.appendChild(a)}) // eslint-disable-line\n","import {\n  script as injectScript,\n  style as injectStyle\n} from './injectors'\n\nexport default function (urls) {\n  const resources = []\n  const deferreds = []\n  const thenables = []\n\n  urls.forEach((url) => deferreds.push(\n    window.fetch(url).then(res => {\n      return [res.clone().text(), res.blob()]\n    }).then(kvArrays => {\n      return Promise.all(kvArrays).then((kvArray) => {\n        resources.push({ text: kvArray[0], type: kvArray[1].type })\n      })\n    })\n  ))\n\n  return Promise.all(deferreds).then(() => {\n    resources.forEach((resource) => {\n      thenables.push({ then: (resolve) => {\n        if (resource.type === 'application/javascript') {\n          injectScript(window, document, 'script', resource.text, resolve())\n        } else if (resource.type === 'text/css') {\n          injectStyle(window, document, 'style', resource.text)\n          resolve()\n        }\n      }})\n    })\n    return Promise.all(thenables)\n  })\n}\n"],"names":["script","i","s","o","g","r","a","m","createElement","getElementsByTagName","appendChild","createTextNode","onload","parentNode","insertBefore","head","style","type","urls","resources","deferreds","thenables","forEach","push","window","fetch","url","then","res","clone","text","blob","kvArrays","Promise","all","kvArray","resource","injectScript","document","resolve","injectStyle"],"mappings":";;;;;;uCAAO,MAAMA,GAAU,SAASC,EAAEC,EAAEC,EAAEC,EAAEC,EAAEC,EAAEC,GAAGD,EAAEJ,EAAEM,cAAcL,GAAGI,EAAEL,EAAEO,qBAAqBN,GAAG,GAAGG,EAAEI,YAAYR,EAAES,eAAeP,IAAIE,EAAEM,OAAOP,EAAEE,EAAEA,EAAEM,WAAWC,aAAaR,EAAEC,GAAGL,EAAEa,KAAKL,YAAYJ,IACxLU,EAAS,SAASf,EAAEC,EAAEC,EAAEC,EAAEC,EAAEC,EAAEC,GAAGD,EAAEJ,EAAEM,cAAcL,GAAGI,EAAEL,EAAEO,qBAAqBN,GAAG,GAAGG,EAAEW,KAAK,WAAWX,EAAEI,YAAYR,EAAES,eAAeP,IAAIG,EAAEA,EAAEM,WAAWC,aAAaR,EAAEC,GAAGL,EAAEa,KAAKL,YAAYJ,GCI3M,OAAe,SAAUY,GACvB,KAAMC,MACAC,KACAC,IAYN,OAVAH,GAAKI,QAAQ,GAASF,EAAUG,KAC9BC,OAAOC,MAAMC,GAAKC,KAAKC,IACrB,OAAQA,EAAIC,QAAQC,OAAQF,EAAIG,UAC/BJ,KAAKK,IACN,MAAOC,SAAQC,IAAIF,GAAUL,KAAK,IAChCR,EAAUI,MAAOO,KAAMK,EAAQ,GAAIlB,KAAMkB,EAAQ,GAAGlB,aAKnDgB,QAAQC,IAAId,GAAWO,UAW5B,MAVAR,GAAUG,QAAQ,IAChBD,EAAUE,MAAOI,KAAM,IACC,2BAAlBS,EAASnB,KACXoB,EAAab,OAAQc,SAAU,SAAUF,EAASN,KAAMS,KAC7B,aAAlBH,EAASnB,OAClBuB,EAAYhB,OAAQc,SAAU,QAASF,EAASN,MAChDS,UAICN,QAAQC,IAAIb"}